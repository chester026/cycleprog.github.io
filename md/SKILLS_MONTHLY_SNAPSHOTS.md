# üìä Skills Change Detection System

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### üìä –õ–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–Ω–∏–º–∫–æ–≤:

1. **–í —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞:** —Å–Ω–∏–º–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–∫–∏–ª–ª–æ–≤ –Ω–∞ ¬±1 –ø—É–Ω–∫—Ç
2. **1-–≥–æ —á–∏—Å–ª–∞ –º–µ—Å—è—Ü–∞:** —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–Ω–∏–º–∫–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ **–ö–†–û–ú–ï –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ**
3. **–¢—Ä–µ–Ω–¥—ã:** –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ 2 —Å–Ω–∏–º–∫–∞–º–∏

---

## üóìÔ∏è –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

### –Ø–Ω–≤–∞—Ä—å 2026:
```
3 —è–Ω–≤: id:1 ‚Üí {climbing: 55, discipline: 38}
5 —è–Ω–≤: id:2 ‚Üí {climbing: 57, discipline: 40} (+2, +2)
10 —è–Ω–≤: id:3 ‚Üí {climbing: 58, discipline: 42} (+1, +2)
25 —è–Ω–≤: id:4 ‚Üí {climbing: 60, discipline: 44} (+2, +2)

UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç—Ä–µ–Ω–¥—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–Ω–∏–º–∫–∞
```

### 1 —Ñ–µ–≤—Ä–∞–ª—è:
```
üóëÔ∏è –£–¥–∞–ª—è–µ–º id:1, id:2, id:3
‚úÖ –û—Å—Ç–∞–≤–ª—è–µ–º id:4 (–ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫ —è–Ω–≤–∞—Ä—è)

–û—Å—Ç–∞–µ—Ç—Å—è: id:4 (25 —è–Ω–≤) ‚Üí {climbing: 60, discipline: 44}
```

### –§–µ–≤—Ä–∞–ª—å 2026:
```
3 —Ñ–µ–≤: id:5 ‚Üí {climbing: 61, discipline: 45} (+1, +1) ‚Üê —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å id:4
15 —Ñ–µ–≤: id:6 ‚Üí {climbing: 63, discipline: 46} (+2, +1) ‚Üê —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å id:5
```

### 1 –º–∞—Ä—Ç–∞:
```
üóëÔ∏è –£–¥–∞–ª—è–µ–º id:5 (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ñ–µ–≤—Ä–∞–ª—å—Å–∫–∏–π)
‚úÖ –û—Å—Ç–∞–≤–ª—è–µ–º id:6 (–ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫ —Ñ–µ–≤—Ä–∞–ª—è)
‚úÖ id:4 (–æ–ø–æ—Ä–Ω—ã–π —è–Ω–≤–∞—Ä—è) –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ—Ç—Ä–æ–Ω—É—Ç—ã–º

–ë–î —Å–æ–¥–µ—Ä–∂–∏—Ç:
- id:4 (25 —è–Ω–≤): –æ–ø–æ—Ä–Ω—ã–π —Å–Ω–∏–º–æ–∫ —è–Ω–≤–∞—Ä—è
- id:6 (15 —Ñ–µ–≤): –æ–ø–æ—Ä–Ω—ã–π —Å–Ω–∏–º–æ–∫ —Ñ–µ–≤—Ä–∞–ª—è
```

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

‚úÖ **–î–µ—Ç–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–∞** - –≤–∏–¥–∏—à—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏  
‚úÖ **–ù–µ —Ä–∞–∑–¥—É–≤–∞–µ—Ç –ë–î** - 1 —Å–Ω–∏–º–æ–∫ –Ω–∞ –º–µ—Å—è—Ü = 12 —Å–Ω–∏–º–∫–æ–≤ –≤ –≥–æ–¥  
‚úÖ **–ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** - –º–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–æ—Å—Ç–∞ –ø–æ –º–µ—Å—è—Ü–∞–º  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** - –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–º–∏

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

### 1. **AnalysisPage.jsx** - –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

```javascript
// –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫
const lastSnapshotRes = await apiFetch('/api/skills-history/last');

let shouldSave = false;

if (!lastSnapshotRes) {
  // –ù–µ—Ç —Å–Ω–∏–º–∫–æ–≤ - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø–µ—Ä–≤—ã–π
  shouldSave = true;
} else {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª—Å—è –ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–∫–∏–ª–ª –Ω–∞ ¬±1 –ø—É–Ω–∫—Ç
  const hasChanges = 
    Math.abs(Math.round(currentSkills.climbing) - Math.round(lastSnapshotRes.climbing)) >= 1 ||
    Math.abs(Math.round(currentSkills.sprint) - Math.round(lastSnapshotRes.sprint)) >= 1 ||
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∫–∏–ª–ª—ã
  
  if (hasChanges) {
    shouldSave = true;
  }
}

if (shouldSave) {
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤—ã–π —Å–Ω–∏–º–æ–∫
  await apiFetch('/api/skills-history', { method: 'POST', body: currentSkills });
}

// –í—ã—á–∏—Å–ª—è–µ–º —Ç—Ä–µ–Ω–¥—ã - —Ä–∞–∑–Ω–∏—Ü–∞ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º —Å–Ω–∏–º–∫–æ–º
if (lastSnapshotRes) {
  setSkillsTrend({
    climbing: Math.round(currentSkills.climbing) - Math.round(lastSnapshotRes.climbing),
    sprint: Math.round(currentSkills.sprint) - Math.round(lastSnapshotRes.sprint),
    // ...
  });
}
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã:

### –ü—Ä–∏–º–µ—Ä 1: –ü–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç (–Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏)
```
–¢–µ–∫—É—â–∏–µ —Å–∫–∏–ª–ª—ã: Climbing: 67, Sprint: 45, ...
–ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫: –ù–ï–¢
‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–µ—Ä–≤—ã–π —Å–Ω–∏–º–æ–∫
‚Üí –¢—Ä–µ–Ω–¥—ã: –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è (–Ω–µ—Ç —Å —á–µ–º —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å)
```

### –ü—Ä–∏–º–µ—Ä 2: –°–∫–∏–ª–ª—ã –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å
```
–¢–µ–∫—É—â–∏–µ —Å–∫–∏–ª–ª—ã: Climbing: 67, Sprint: 45, Endurance: 58, ...
–ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫: Climbing: 67, Sprint: 45, Endurance: 58, ...
‚Üí –ò–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ—Ç - –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–µ–º
‚Üí –¢—Ä–µ–Ω–¥—ã: 0 / 0 / 0 (–≤—Å–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
```

### –ü—Ä–∏–º–µ—Ä 3: Climbing –≤—ã—Ä–æ—Å –Ω–∞ +2
```
–¢–µ–∫—É—â–∏–µ —Å–∫–∏–ª–ª—ã: Climbing: 69, Sprint: 45, Endurance: 58, ...
–ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫: Climbing: 67, Sprint: 45, Endurance: 58, ...
‚Üí Climbing –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ +2 ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤—ã–π —Å–Ω–∏–º–æ–∫
‚Üí –¢—Ä–µ–Ω–¥—ã: Climbing +2‚¨ÜÔ∏è, Sprint 0, Endurance 0, ...
```

### –ü—Ä–∏–º–µ—Ä 4: –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–∫–∏–ª–ª–æ–≤ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å
```
–¢–µ–∫—É—â–∏–µ —Å–∫–∏–ª–ª—ã: Climbing: 69, Sprint: 47, Endurance: 56, ...
–ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫: Climbing: 67, Sprint: 45, Endurance: 58, ...
‚Üí Climbing +2, Sprint +2, Endurance -2 ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º
‚Üí –¢—Ä–µ–Ω–¥—ã: Climbing +2‚¨ÜÔ∏è, Sprint +2‚¨ÜÔ∏è, Endurance -2‚¨áÔ∏è, ...
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–¢–∞–±–ª–∏—Ü–∞ `skills_history`:**// –í JSX:
<p className="skills-subtitle">{skillsPeriod}</p>
// –í–º–µ—Å—Ç–æ: "Based on last 3 months of activities"
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Oct‚ÄìDec 2025")
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç, –∑–∞ –∫–∞–∫–∏–µ –º–µ—Å—è—Ü—ã –ø–æ–∫–∞–∑–∞–Ω—ã –Ω–∞–≤—ã–∫–∏
- ‚úÖ –ü–æ–Ω—è—Ç–Ω–æ, –∫–æ–≥–¥–∞ –∂–¥–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (1-–≥–æ —á–∏—Å–ª–∞)

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

### 1. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** ‚≠ê‚≠ê‚≠ê
- –ù–∞–≤—ã–∫–∏ **–Ω–µ –º–µ–Ω—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å**
- –í–µ—Å—å –º–µ—Å—è—Ü –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Å–∫–æ—Ä
- –ú–æ–∂–Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å

### 2. **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å** ‚≠ê‚≠ê‚≠ê
- –ò–∑–≤–µ—Å—Ç–Ω–æ, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (1-–≥–æ —á–∏—Å–ª–∞)
- –ü–æ–Ω—è—Ç–Ω–æ, –∑–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ —Å—á–∏—Ç–∞–µ—Ç—Å—è (Oct‚ÄìDec 2025)
- –õ–æ–≥–∏—á–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

### 3. **–ú–æ—Ç–∏–≤–∞—Ü–∏—è** ‚≠ê‚≠ê
- –í–∏–¥–∏—à—å —á–µ—Ç–∫–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç –º–µ—Å—è—Ü–∞ –∫ –º–µ—Å—è—Ü—É
- –¢—Ä–µ–Ω–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ù–µ –ø—É–≥–∞—é—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è

### 4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚≠ê
- –ù–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –Ω–∞–≤—ã–∫–∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑
- –ú–æ–∂–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

---

## üìä –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

### **2 —è–Ω–≤–∞—Ä—è 2026:**
```
Skills: Oct‚ÄìDec 2025
Climbing: 67 +2‚¨ÜÔ∏è  (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Å–µ–Ω—Ç—è–±—Ä—å-–Ω–æ—è–±—Ä—å)
Sprint: 45
Endurance: 58
Tempo: 60
Power: 55
Discipline: 68
Overall: 59

Rider Profile: Climber
```

### **15 —è–Ω–≤–∞—Ä—è 2026:**
```
Skills: Oct‚ÄìDec 2025
Climbing: 67 +2‚¨ÜÔ∏è  (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô!)
Sprint: 45
Endurance: 58
Tempo: 60
Power: 55
Discipline: 68
Overall: 59

Rider Profile: Climber
```

### **1 —Ñ–µ–≤—Ä–∞–ª—è 2026:**
```
Skills: Nov 2025‚ÄìJan 2026
Climbing: 70 +3‚¨ÜÔ∏è  (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Oct‚ÄìDec 2025)
Sprint: 47 +2‚¨ÜÔ∏è
Endurance: 60 +2‚¨ÜÔ∏è
Tempo: 62 +2‚¨ÜÔ∏è
Power: 57 +2‚¨ÜÔ∏è
Discipline: 70 +2‚¨ÜÔ∏è
Overall: 61 +2‚¨ÜÔ∏è

Rider Profile: Climber
```

**–ü—Ä–æ–≥—Ä–µ—Å—Å –≤–∏–¥–µ–Ω! üöÄ**

---

## üîç Debug –ª–æ–≥–∏:

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –∫–æ–Ω—Å–æ–ª–∏:

```javascript
üìä Skills History Check: {
  today: "2026-01-15",
  lastSnapshot: "2026-01-01",
  shouldSave: false,
  isFirstOfMonth: false
}
// –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫
```

```javascript
üìä Skills History Check: {
  today: "2026-02-01",
  lastSnapshot: "2026-01-01",
  shouldSave: true,
  isFirstOfMonth: true
}
üíæ Saving new skills snapshot...
‚úÖ Skills snapshot saved!
// –°–æ—Ö—Ä–∞–Ω–∏–ª–∏ –Ω–æ–≤—ã–π —Å–Ω–∏–º–æ–∫ –∑–∞ —Ñ–µ–≤—Ä–∞–ª—å
```

---

## üìù –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

–¢–∞–±–ª–∏—Ü–∞ `skills_history` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–Ω–∏–º–∫–∏:

```sql
SELECT * FROM skills_history WHERE user_id = 1 ORDER BY snapshot_date DESC;

| id | user_id | snapshot_date | climbing | sprint | endurance | tempo | power | consistency |
|----|---------|---------------|----------|--------|-----------|-------|-------|-------------|
| 3  | 1       | 2026-02-01    | 70       | 47     | 60        | 62    | 57    | 70          |
| 2  | 1       | 2026-01-01    | 67       | 45     | 58        | 60    | 55    | 68          |
| 1  | 1       | 2025-12-01    | 65       | 43     | 56        | 58    | 53    | 66          |
```

**–û–¥–∏–Ω —Å–Ω–∏–º–æ–∫ = –æ–¥–∏–Ω –º–µ—Å—è—Ü**

---

## üéØ –ò—Ç–æ–≥–æ:

| –†–∞–Ω—å—à–µ (—Å–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ) | –°–µ–π—á–∞—Å (–º–µ—Å—è—á–Ω—ã–µ —Å–Ω–∏–º–∫–∏) |
|---------------------------|---------------------------|
| ‚ùå –ú–µ–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å | ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ –≤–µ—Å—å –º–µ—Å—è—Ü |
| ‚ùå –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ | ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ 1-–≥–æ —á–∏—Å–ª–∞ |
| ‚ùå "–í—á–µ—Ä–∞ –±—ã–ª–æ 67, —Å–µ–≥–æ–¥–Ω—è 65, –ø–æ—á–µ–º—É?" | ‚úÖ "–í–µ—Å—å —è–Ω–≤–∞—Ä—å 67, –≤ —Ñ–µ–≤—Ä–∞–ª–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º" |
| ‚ùå –ù–µ—Ç –º–æ—Ç–∏–≤–∞—Ü–∏–∏ | ‚úÖ –ß–µ—Ç–∫–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç –º–µ—Å—è—Ü–∞ –∫ –º–µ—Å—è—Ü—É |

**–¢–µ–ø–µ—Ä—å –Ω–∞–≤—ã–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å! üí™**

